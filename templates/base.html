<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!-->
{% load staticfiles %}
<html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>接力棒内部管理系统</title>
    <meta name="description" content="接力棒内部管理系统">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" href="{% static "images/jlb.png" %}" type="image/png">
    <link rel="stylesheet" href="{% static "assets/css/normalize.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/bootstrap.min.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/font-awesome.min.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/themify-icons.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/pe-icon-7-filled.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/flag-icon.min.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/cs-skin-elastic.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/style.css" %}">
    <link rel="stylesheet" href="{% static "assets/css/lib/datatable/dataTables.bootstrap.min.css" %}">
    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->
    <link href="{% static "assets/weather/css/weather-icons.css" %}" rel="stylesheet"/>
    <link href="{% static "assets/calendar/fullcalendar.css" %}" rel="stylesheet"/>

    <link href="{% static "assets/css/charts/chartist.min.css" %}" rel="stylesheet">
    <link href="{% static "assets/css/lib/vector-map/jqvmap.min.css" %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static "assets/css/lib/chosen/chosen.min.css" %}">

    <style>
        #weatherWidget .currentDesc {
            color: #ffffff !important;
        }

        #flotPie1 td {
            padding: 3px;
        }

        #flotPie1 table {
            top: 20px !important;
            right: -10px !important;
        }
    </style>
</head>
<body>
<!-- Left Panel -->
{% if user.is_authenticated %}
    {% include "left-pannl.html" %}
{% endif %}
<!-- /#left-panel -->
<!-- Right Panel -->
<div id="right-panel" class="right-panel">
    <!-- Header-->
    {% include "header.html" %}
    <!-- /#header -->
    <!-- Content -->
    {% block content %}{% endblock %}
    <!-- /.content -->
    <div class="clearfix"></div>
    <!-- Footer -->
    {% include "site-footer.html" %}
    <!-- /.site-footer -->
</div>
<!-- /#right-panel -->

<script src="{% static "assets/js/vendor/jquery-2.1.4.min.js" %}"></script>

<script src="{% static "assets/js/popper.min.js" %}"></script>
<script src="{% static "assets/js/plugins.js" %}"></script>
<script src="{% static "assets/js/main.js" %}"></script>
<script src="{% static "assets/js/lib/chart-js/view-source_https___colorlib.com_polygon_elaadmin_assets_js_lib_chart-js_Chart.bundle.js" %}"></script>
<script src="{% static "assets/js/lib/chartist/chartist.min.js" %}"></script>
<script src="{% static "assets/js/lib/chartist/chartist-plugin-legend.js" %}"></script>
<script src="{% static "assets/js/lib/flot-chart/jquery.flot.js" %}"></script>
<script src="{% static "assets/js/lib/flot-chart/jquery.flot.pie.js" %}"></script>
<script src="{% static "assets/js/lib/flot-chart/jquery.flot.spline.js" %}"></script>
<script src="{% static "assets/weather/js/jquery.simpleWeather.min.js" %}"></script>
<script src="{% static "assets/weather/js/weather-init.js" %}"></script>
<script src="{% static "assets/js/moment/moment.js" %}"></script>
<script src="{% static "assets/calendar/fullcalendar.min.js" %}"></script>
<script src="{% static "assets/calendar/fullcalendar-init.js" %}"></script>
<script src="{% static "assets/js/init/weather-init.js" %}"></script>
<script src="{% static "layui/layui.js" %}"></script>
<link href="{% static "layui/css/layui.css" %}" rel="stylesheet" media="all"/>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.9.0/dist/fullcalendar.min.js"></script>
<script src="{% static "assets/js/init/fullcalendar-init.js" %}"></script>

<script src="{% static "assets/js/jquery.matchHeight.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/datatables.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/dataTables.bootstrap.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/dataTables.buttons.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/buttons.bootstrap.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/jszip.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/vfs_fonts.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/buttons.html5.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/buttons.print.min.js" %}"></script>
<script src="{% static "assets/js/lib/data-table/buttons.colVis.min.js" %}"></script>
<script src="{% static "assets/js/init/datatables-init.js" %}"></script>
<script src="{% static "myjs/show.js" %}"></script>
<script src="{% static "assets/js/lib/chosen/chosen.jquery.min.js" %}"></script>
<script src="{% static "jquery-validation-1.14.0/dist/localization/messages_zh.js" %}"></script>
<script src="{% static "jquery-validation-1.14.0/dist/jquery.validate.min.js" %}"></script>
<script src="https://code.highcharts.com.cn/highcharts/highcharts.js"></script>
<script src="https://code.highcharts.com.cn/highcharts/modules/exporting.js"></script>
<script src="https://img.hcharts.cn/highcharts-plugins/highcharts-zh_CN.js"></script>
<script src="https://code.highcharts.com.cn/highcharts/modules/oldie.js"></script>

{# 新增div节点#}
<script type="text/javascript">
    var detail_div = 1;

    function add_div() {
        var e = document.getElementById("details");
        var div = document.createElement("div");
        div.className = "form-group";
        div.id = "details" + detail_div;
        div.innerHTML = e.innerHTML;
        document.getElementById("validate").appendChild(div);
        detail_div++;
    }

    function del_div() {
        var id = "details" + (detail_div - 1).toString();
        var e = document.getElementById(id);
        document.getElementById("validate").removeChild(e);
        detail_div--;
    }
</script>
{# buildId 二级联动#}
<script>
    function change(e, v) {
        var id = e.parentNode.parentNode.parentNode.parentNode.id;
        $.ajax({
            url: '/ajax_load_buildIds',
            type: 'GET',
            dataType: 'json',
            data: {'jenkins_job_name': v},

            success: function (data) {
                console.log(data);
                var html = "";
                for (var i = 0; i < data.length; i++) {
                    var item = data[i];

                    html += "<option>" + item.uat_buildId + "</option>";
                }
                $(`#${id} #buildId`).html(html);
            }
        })
    }
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#bootstrap-data-table-export').DataTable();
    });
</script>
<!--柱状图 -->
<script>
    var chart = Highcharts.chart('taskCountsPerMonth', {
        chart: {
            type: 'column'
        },
        title: {
            text: '任务执行数'
        },
        subtitle: {
            text: '数据来源: deploymanage.bestjlb.cn'
        },
        xAxis: {
            categories: [
                '一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'
            ],
            crosshair: true
        },
        yAxis: {
            min: 0,
            title: {
                text: '任务数 (个)'
            }
        },
        tooltip: {
            // head + 每个 point + footer 拼接成完整的 table
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        plotOptions: {
            column: {
                borderWidth: 0
            }
        },
        series: [
                {% for monthPlan in monthAllPlan %}{
                    name: '{{ monthPlan.0.0 }}',
                    data: {{ monthPlan.1 }}
                    },{% endfor %}]
    });
</script>
<!--折线图 -->
<script>
    var chart = Highcharts.chart('taskCountsPerMonth1', {
        chart: {
            type: 'line'
        },
        title: {
            text: '任务执行数'
        },
        subtitle: {
            text: '数据来源: deploymanage.bestjlb.cn'
        },
        xAxis: {
            categories: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月']
        },
        yAxis: {
            title: {
                text: '任务数 (个)'
            }
        },
        plotOptions: {
            line: {
                dataLabels: {
                    // 开启数据标签
                    enabled: true
                },
                // 关闭鼠标跟踪，对应的提示框、点击事件会失效
                enableMouseTracking: false
            }
        },
        series: [
                {% for monthPlan in monthAllPlan %}{
                    name: '{{ monthPlan.0.0 }}',
                    data: {{ monthPlan.1 }}
                    },{% endfor %}]
    });
</script>
<!-- 搜索下拉框 -->
<script>
    jQuery(document).ready(function () {
        jQuery(".standardSelect").chosen({
            disable_search_threshold: 5,
            no_results_text: "未找到!",
            width: "100%"
        });
    });
</script>
<!--任务删除 -->
<script>
    function deleteTask(obj) {
        var tr=$(obj).parent().parent();
        var taskId = tr.children("td#taskId").text();
        var postData = {};
        postData['id'] = taskId;
        console.log(taskId);

        $.ajax({
            url: '/ajax_deleteTask',
            type: 'POST',
            data: postData,

            success: function (arg) {
                if (arg.length > 0) {
                    tr.remove();
                }
            },
            error: function () {
                console.log("error");
            }
        })
    }
</script>
<!--计划删除 -->
<script>
    function deletePlan(obj) {
        var tr=$(obj).parent().parent();
        var planId = tr.children("td#planId").text();
        var postData = {};
        postData['id'] = planId;
        console.log(planId);

        $.ajax({
            url: '/ajax_deletePlan',
            type: 'POST',
            data: postData,

            success: function (arg) {
                if (arg.length > 0) {
                    tr.remove();
                }
            },
            error: function () {
                console.log("error");
            }
        })
    }
</script>
</body>
</html>